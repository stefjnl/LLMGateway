# US-006A: Web UI Implementation

---

## User Story

**As a** developer demonstrating the LLM Gateway  
**I want** a simple web interface to interact with the API  
**So that** recruiters and hiring managers can see the application working without technical setup

---

## Implementation Approach

### Styling Strategy

**Base**: Tailwind CSS utilities (already in your project)

**Enhancements from your AI Code Reviewer**:
- Gradient backgrounds with subtle animations
- VS Code-inspired dark theme
- Modern card-based layout
- Professional button system with hover effects
- Custom shadow system for depth
- Glassmorphism effects (backdrop blur)
- Smooth transitions throughout

**What we'll skip**:
- Multi-step workflow (not relevant for chat)
- Directory browser modal
- SignalR real-time updates (overkill for MVP)
- Form validation UI (API handles this)

---

## File Structure

```
src/LLMGateway.Api/wwwroot/
â”œâ”€â”€ index.html
â”œâ”€â”€ css/
â”‚   â”œâ”€â”€ app.css                 (imports all CSS)
â”‚   â”œâ”€â”€ base/
â”‚   â”‚   â”œâ”€â”€ _variables.css      (color palette, spacing)
â”‚   â”‚   â””â”€â”€ _utilities.css      (custom Tailwind extensions)
â”‚   â””â”€â”€ components/
â”‚       â”œâ”€â”€ _chat.css           (chat-specific styles)
â”‚       â””â”€â”€ _animations.css     (loading, gradients)
â””â”€â”€ js/
    â””â”€â”€ chat.js                 (API integration)

src/LLMGateway.Api/Program.cs
â””â”€â”€ app.UseStaticFiles();       (enable wwwroot)
```

---

## Acceptance Criteria

### âœ… Criterion 1: Static File Serving
- [ ] `Program.cs` enables `UseStaticFiles()` middleware
- [ ] `index.html` accessible at `http://localhost:5047/`
- [ ] CSS and JS files load correctly

### âœ… Criterion 2: Chat Interface Layout
- [ ] Header with gradient background and health indicator
- [ ] Chat message container (scrollable)
- [ ] User messages: right-aligned, blue gradient
- [ ] Assistant messages: left-aligned, dark gradient
- [ ] Message metadata: model, tokens, cost displayed below each response

### âœ… Criterion 3: Input Controls
- [ ] Multi-line text area for message input
- [ ] Model override dropdown (Auto, glm-4.6, DeepSeek, Kimi-K2)
- [ ] Temperature slider (0.0 - 2.0) with live value display
- [ ] Max tokens input (optional, default from backend)
- [ ] Send button with gradient styling and disabled state

### âœ… Criterion 4: Real-Time API Integration
- [ ] Send button triggers POST to `/v1/ChatCompletion`
- [ ] Loading spinner while waiting for response
- [ ] Display assistant response with metadata
- [ ] Maintain conversation history (all messages sent to API)
- [ ] Clear button to reset conversation

### âœ… Criterion 5: Cost Tracking
- [ ] Running total of tokens used (input + output)
- [ ] Running total of estimated cost (USD)
- [ ] Display per-message cost and tokens
- [ ] Reset totals when clearing conversation

### âœ… Criterion 6: Health Status Indicator
- [ ] Poll `/health/ready` every 30 seconds
- [ ] Green dot + "Healthy" when 200 OK
- [ ] Red dot + "Unhealthy" when 503 or timeout
- [ ] Display in header next to title

### âœ… Criterion 7: Error Handling
- [ ] Display validation errors from 400 responses
- [ ] Show service unavailable message for 503
- [ ] Display correlation ID from ProblemDetails
- [ ] Error toast appears for 5 seconds then fades
- [ ] Errors don't break UI state

### âœ… Criterion 8: Responsive Design
- [ ] Mobile-friendly layout (â‰¥320px width)
- [ ] Touch-friendly button sizes (â‰¥44px)
- [ ] Readable font sizes on small screens
- [ ] Chat container scrolls properly on mobile

### âœ… Criterion 9: Accessibility
- [ ] Proper focus indicators on interactive elements
- [ ] Keyboard navigation works (Tab, Enter to send)
- [ ] ARIA labels on buttons and inputs
- [ ] Color contrast meets WCAG AA standards

### âœ… Criterion 10: Visual Polish
- [ ] Smooth transitions on all interactions
- [ ] Loading states prevent double-clicks
- [ ] Gradient animations subtle and performant
- [ ] Dark theme with VS Code-inspired colors
- [ ] Professional shadow system for depth

---

## Design Mockup

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¤– LLM Gateway                              [â—] Healthy    â”‚ â† Gradient header
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚  [User Message]                                            â”‚ â† Right-aligned
â”‚  Hello, can you help me?                                   â”‚   Blue gradient
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚            [Assistant Message]                             â”‚ â† Left-aligned
â”‚            Of course! How can I assist you today?          â”‚   Dark gradient
â”‚            â”œâ”€ Model: glm-4.6                               â”‚   
â”‚            â”œâ”€ Tokens: 25                                   â”‚
â”‚            â””â”€ Cost: $0.000001                              â”‚
â”‚                                                             â”‚
â”‚                                                             â”‚
â”‚  [User Message]                                            â”‚
â”‚  What's the weather like?                                  â”‚
â”‚                                                             â”‚
â”‚            [Loading Spinner...]                            â”‚ â† While waiting
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Model: [Auto â–¼]  Temperature: 0.7 [â”â”â”â”â”â—‹â”â”â”â”]  Max: []  â”‚ â† Controls
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [Type your message here...                            ]   â”‚ â† Text area
â”‚  [                                                      ]   â”‚
â”‚                                      [Clear] [Send â†’]      â”‚ â† Buttons
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ’° Total: 150 tokens  |  $0.000015                        â”‚ â† Cost tracker
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## CSS Architecture

### _variables.css (Core Palette)

```css
:root {
  /* From your AI Code Reviewer - adapted for LLM Gateway */
  --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
  --gradient-dark: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
  
  /* VS Code-inspired dark theme */
  --color-bg-dark: #1e1e1e;
  --color-surface-dark: #252526;
  --color-border-dark: #3e3e42;
  --color-text-dark: #d4d4d4;
  
  /* Status colors */
  --color-success: #10b981;
  --color-error: #ef4444;
  --color-warning: #f59e0b;
  
  /* Shadows */
  --shadow-modern-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
  --shadow-modern-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
  --shadow-modern-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
}
```

### _animations.css (Loading & Gradients)

```css
@keyframes gradient-x {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

@keyframes fade-in {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.animate-gradient-x {
  background-size: 200% 200%;
  animation: gradient-x 15s ease infinite;
}

.animate-spin {
  animation: spin 1s linear infinite;
}

.animate-fade-in {
  animation: fade-in 0.3s ease-out;
}
```

---

## HTML Structure (Key Sections)

### Header
```html
<header class="bg-gradient-to-r from-slate-900 via-purple-900 to-slate-900 
               backdrop-blur-lg border-b border-white/10">
  <div class="container mx-auto px-4 py-4 flex justify-between items-center">
    <h1 class="text-2xl font-bold text-white">ğŸ¤– LLM Gateway</h1>
    <div id="health-status" class="flex items-center gap-2">
      <div class="w-3 h-3 rounded-full bg-green-500"></div>
      <span class="text-sm text-white">Healthy</span>
    </div>
  </div>
</header>
```

### Chat Container
```html
<div id="chat-container" class="flex-1 overflow-y-auto p-4 space-y-4">
  <!-- Messages dynamically inserted here -->
</div>
```

### User Message Template (JavaScript will clone)
```html
<template id="user-message-template">
  <div class="flex justify-end animate-fade-in">
    <div class="max-w-[80%] rounded-2xl bg-gradient-to-br from-blue-500 to-blue-600 
                text-white p-4 shadow-modern-md">
      <p class="text-sm"></p>
    </div>
  </div>
</template>
```

### Assistant Message Template
```html
<template id="assistant-message-template">
  <div class="flex justify-start animate-fade-in">
    <div class="max-w-[80%] rounded-2xl bg-gradient-to-br from-slate-700 to-slate-800 
                text-white p-4 shadow-modern-md">
      <p class="text-sm mb-3"></p>
      <div class="flex gap-4 text-xs text-gray-300 border-t border-white/10 pt-2">
        <span>Model: <span class="font-mono"></span></span>
        <span>Tokens: <span class="font-mono"></span></span>
        <span>Cost: <span class="font-mono">$</span></span>
      </div>
    </div>
  </div>
</template>
```

### Controls Section
```html
<div class="border-t border-gray-200 bg-white p-4">
  <div class="container mx-auto max-w-4xl">
    <!-- Model + Temperature controls -->
    <div class="flex gap-4 mb-3">
      <div class="flex-1">
        <label class="text-xs text-gray-600">Model</label>
        <select id="model-select" class="w-full px-3 py-2 border rounded-lg">
          <option value="">Auto</option>
          <option value="z-ai/glm-4.6">glm-4.6 (Default)</option>
          <option value="deepseek-ai/DeepSeek-V3.1-Terminus">DeepSeek V3.1</option>
          <option value="moonshotai/Kimi-K2-Instruct-0905">Kimi K2 (Large Context)</option>
        </select>
      </div>
      
      <div class="flex-1">
        <label class="text-xs text-gray-600">Temperature: 
          <span id="temp-value" class="font-mono">0.7</span>
        </label>
        <input type="range" id="temperature" min="0" max="2" step="0.1" value="0.7" 
               class="w-full"/>
      </div>
    </div>
    
    <!-- Message input -->
    <textarea id="message-input" rows="3" 
              placeholder="Type your message here..."
              class="w-full px-4 py-3 border rounded-lg resize-none focus:ring-2 
                     focus:ring-blue-500 focus:outline-none"></textarea>
    
    <!-- Action buttons -->
    <div class="flex justify-between items-center mt-3">
      <div class="text-sm text-gray-600">
        ğŸ’° Total: <span id="total-tokens" class="font-mono">0</span> tokens | 
        $<span id="total-cost" class="font-mono">0.000000</span>
      </div>
      <div class="flex gap-2">
        <button id="clear-btn" 
                class="px-4 py-2 text-gray-600 hover:text-gray-900 transition">
          Clear
        </button>
        <button id="send-btn" 
                class="px-6 py-2 bg-gradient-to-r from-blue-500 to-blue-600 
                       text-white rounded-lg hover:shadow-modern-lg 
                       transition-all transform hover:-translate-y-0.5
                       disabled:opacity-50 disabled:cursor-not-allowed">
          Send â†’
        </button>
      </div>
    </div>
  </div>
</div>
```

---

## JavaScript Logic (chat.js)

### State Management
```javascript
const state = {
  messages: [],  // Conversation history
  totalTokens: 0,
  totalCost: 0,
  isLoading: false
};
```

### Core Functions

**1. Send Message**
```javascript
async function sendMessage() {
  const input = document.getElementById('message-input');
  const content = input.value.trim();
  if (!content || state.isLoading) return;
  
  // Add user message to history
  state.messages.push({ role: 'user', content });
  appendUserMessage(content);
  
  // Show loading, disable input
  state.isLoading = true;
  showLoading();
  
  try {
    const response = await fetch('/v1/ChatCompletion', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        messages: state.messages,
        model: getSelectedModel(),
        temperature: getTemperature()
      })
    });
    
    if (!response.ok) {
      const error = await response.json();
      showError(error);
      return;
    }
    
    const result = await response.json();
    
    // Add assistant response to history
    state.messages.push({ role: 'assistant', content: result.content });
    appendAssistantMessage(result);
    
    // Update totals
    state.totalTokens += result.tokensUsed;
    state.totalCost += result.estimatedCostUsd;
    updateTotals();
    
  } catch (error) {
    showError({ detail: 'Network error. Is the API running?' });
  } finally {
    state.isLoading = false;
    hideLoading();
    input.value = '';
  }
}
```

**2. Health Check Polling**
```javascript
async function checkHealth() {
  try {
    const response = await fetch('/health/ready');
    updateHealthIndicator(response.ok);
  } catch {
    updateHealthIndicator(false);
  }
}

// Poll every 30 seconds
setInterval(checkHealth, 30000);
checkHealth(); // Initial check
```

**3. DOM Manipulation**
```javascript
function appendUserMessage(content) {
  const template = document.getElementById('user-message-template');
  const clone = template.content.cloneNode(true);
  clone.querySelector('p').textContent = content;
  document.getElementById('chat-container').appendChild(clone);
  scrollToBottom();
}

function appendAssistantMessage(result) {
  const template = document.getElementById('assistant-message-template');
  const clone = template.content.cloneNode(true);
  
  clone.querySelector('p').textContent = result.content;
  clone.querySelectorAll('.font-mono')[0].textContent = result.model;
  clone.querySelectorAll('.font-mono')[1].textContent = result.tokensUsed;
  clone.querySelectorAll('.font-mono')[2].textContent = 
    result.estimatedCostUsd.toFixed(6);
  
  document.getElementById('chat-container').appendChild(clone);
  scrollToBottom();
}
```

**4. Error Handling**
```javascript
function showError(problemDetails) {
  const toast = document.createElement('div');
  toast.className = `fixed top-4 right-4 bg-red-500 text-white px-6 py-4 
                     rounded-lg shadow-modern-lg animate-fade-in z-50`;
  
  toast.innerHTML = `
    <div class="font-semibold">${problemDetails.title || 'Error'}</div>
    <div class="text-sm mt-1">${problemDetails.detail || 'Something went wrong'}</div>
    ${problemDetails.correlationId ? 
      `<div class="text-xs mt-2 opacity-75">ID: ${problemDetails.correlationId}</div>` 
      : ''}
  `;
  
  document.body.appendChild(toast);
  setTimeout(() => toast.remove(), 5000);
}
```

---

## Program.cs Changes

```csharp
// After var app = builder.Build();

// Enable static files BEFORE other middleware
app.UseStaticFiles();

// Existing middleware (exception handler, CORS, etc.)
// ...

// Serve index.html at root
app.MapGet("/", () => Results.Redirect("/index.html"));
```

---

## Time Estimate

- **HTML structure**: 45 minutes
- **CSS styling** (variables, animations, chat components): 45 minutes
- **JavaScript logic** (API integration, DOM manipulation): 60 minutes
- **Error handling & polish**: 30 minutes
- **Testing & mobile responsive**: 30 minutes
- **Total**: **3.5 hours**

---

## Testing Checklist

### Functional
- [ ] Send message â†’ receives response
- [ ] Loading spinner appears during request
- [ ] Messages display correctly (user vs assistant)
- [ ] Cost/token totals update
- [ ] Model override works
- [ ] Temperature slider affects response
- [ ] Clear button resets conversation
- [ ] Health indicator polls correctly
- [ ] Errors display as toasts

### Visual
- [ ] Gradients animate smoothly
- [ ] Shadows create depth
- [ ] Hover effects work on buttons
- [ ] Loading states prevent interaction
- [ ] Mobile layout doesn't break
- [ ] Text remains readable at all sizes

### Edge Cases
- [ ] Empty message doesn't send
- [ ] Rapid clicking doesn't duplicate requests
- [ ] Long messages don't break layout
- [ ] Network errors show user-friendly message
- [ ] 503 errors display "service unavailable"
- [ ] Correlation IDs appear in error toasts

---

## Definition of Done

- [ ] `index.html` serves at root URL
- [ ] Chat interface matches design mockup
- [ ] User/assistant messages styled correctly with gradients
- [ ] Model selector and temperature slider functional
- [ ] POST to `/v1/ChatCompletion` works end-to-end
- [ ] Loading spinner appears during API calls
- [ ] Cost/token tracking updates in real-time
- [ ] Health indicator polls `/health/ready` every 30 seconds
- [ ] Error toasts display ProblemDetails with correlation IDs
- [ ] Mobile responsive (â‰¥320px width)
- [ ] Keyboard navigation works (Tab, Enter)
- [ ] Clear button resets conversation and totals
- [ ] Gradients animate subtly in header
- [ ] Shadows provide visual depth
- [ ] All transitions smooth (300ms)

---

## Success Metrics

**Portfolio Impact**:
- Recruiter can visit URL, type message, see response in <30 seconds
- Visual polish demonstrates UI/UX capability
- Cost tracking shows business logic awareness
- Error handling shows production-readiness thinking

**Technical Demonstration**:
- Full-stack capability (backend + frontend)
- REST API consumption patterns
- Modern CSS architecture (gradients, animations, responsive)
- JavaScript async/await patterns
- Error handling with correlation IDs